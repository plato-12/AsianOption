% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{price_kemna_vorst_arithmetic_cpp}
\alias{price_kemna_vorst_arithmetic_cpp}
\title{Kemna-Vorst Monte Carlo Simulation for Arithmetic Average Asian Option}
\usage{
price_kemna_vorst_arithmetic_cpp(
  S0,
  K,
  r,
  sigma,
  T0,
  T,
  n,
  M,
  option_type = "call",
  use_control_variate = TRUE,
  seed = 0L
)
}
\arguments{
\item{S0}{Initial stock price at time T0}

\item{K}{Strike price}

\item{r}{Continuously compounded risk-free rate}

\item{sigma}{Volatility (annualized)}

\item{T0}{Start of averaging period}

\item{T}{Maturity time}

\item{n}{Number of averaging points (observations)}

\item{M}{Number of Monte Carlo simulations}

\item{option_type}{String: "call" or "put"}

\item{use_control_variate}{Boolean: use variance reduction (default TRUE)}

\item{seed}{Integer: random seed for reproducibility (default 0 = no seed)}
}
\value{
List containing:
\describe{
  \item{price}{Estimated option price}
  \item{std_error}{Standard error of the estimate}
  \item{lower_ci}{Lower 95\% confidence interval}
  \item{upper_ci}{Upper 95\% confidence interval}
  \item{geometric_price}{Analytical geometric average price (control variate)}
  \item{correlation}{Correlation between arithmetic and geometric payoffs}
  \item{variance_reduction_factor}{Ratio of variances (with/without control variate)}
}
}
\description{
Implements the Kemna-Vorst (1990) Monte Carlo method with variance reduction
using the geometric average as a control variate. This is the standard
benchmark implementation WITHOUT price impact.
}
\details{
The algorithm follows Kemna & Vorst (1990):

1. Generate price paths under risk-neutral dynamics:
   \deqn{\log(S_{i+1}) = \log(S_i) + (r - \sigma^2/2)\Delta t + \sigma\sqrt{\Delta t} Z_i}
   where \eqn{Z_i \sim N(0,1)}

2. Calculate arithmetic and geometric averages for each path:
   \deqn{A = \frac{1}{n+1}\sum_{i=0}^{n} S_i}
   \deqn{G = \left(\prod_{i=0}^{n} S_i\right)^{1/(n+1)}}

3. Calculate discounted payoffs:
   \deqn{Y = e^{-r\tau} \max(A - K, 0)}
   \deqn{W = e^{-r\tau} \max(G - K, 0)}

4. Use control variate method to reduce variance:
   \deqn{\hat{C}_{enhanced} = E[W] + \frac{1}{M}\sum_{j=1}^{M}(Y_j - W_j)}

where \eqn{E[W]} is the analytical geometric average price.

The variance reduction can be dramatic (factor 10-70) because the
correlation between arithmetic and geometric averages is typically > 0.95.
}
\examples{
\donttest{
# Basic example
result <- price_kemna_vorst_arithmetic_cpp(
  S0 = 100, K = 100, r = 0.05, sigma = 0.2,
  T0 = 0, T = 1, n = 50, M = 10000,
  option_type = "call"
)
print(result$price)
print(result$std_error)
}

}
\references{
Kemna, A.G.Z. and Vorst, A.C.F. (1990). "A Pricing Method for Options Based
on Average Asset Values." \emph{Journal of Banking and Finance}, 14, 113-129.
}
